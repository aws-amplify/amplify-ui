#!/bin/sh
branch="$(git branch --show-current)"

if [ "$branch" = "main" ]; then
  echo "Direct commits to main branch are not allowed."
  exit 1
fi

# Revert updates to storybookLoader.js autogenerated by `storybook` in the React Native Example app
story_loader_path="examples/react-native/storybook/storyLoader.js"
status="$(git status --porcelain)"
if [[ $status == *$story_loader_path* ]]; then
  git checkout HEAD -- $story_loader_path
  echo "Revert updates to $story_loader_path"
fi

. "$(dirname "$0")/_/husky.sh"

npx lint-staged
