import { Alert } from '@aws-amplify/ui-react';
import PasswordlessExample from './passwordless.example.web.mdx';

### Passwordless Authentication

<Alert role="none" variation="info" heading="Platform Requirements">
  WebAuthn (Passkey) support requires modern browsers with WebAuthn API support.
</Alert>

#### Backend Configuration

For backend setup including Email OTP, SMS OTP, and WebAuthn (Passkey) configuration, see the [Passwordless documentation](https://docs.amplify.aws/react/build-a-backend/auth/concepts/passwordless/).

#### Basic Usage

The Authenticator automatically detects passwordless authentication methods from your backend (`amplify_outputs.json`):

<PasswordlessExample />

#### Available Authentication Methods

| Method | Description | Code |
|--------|-------------|------|
| PASSWORD | Traditional password authentication | `'PASSWORD'` |
| EMAIL_OTP | One-time code via email | `'EMAIL_OTP'` |
| SMS_OTP | One-time code via SMS | `'SMS_OTP'` |
| WEB_AUTHN | Biometric/security key authentication (Passkey) | `'WEB_AUTHN'` |

#### Configuration

Use the `passwordless` prop to:
- Override settings from `amplify_outputs.json` (Gen 2)
- Configure passwordless for Gen 1 backends

```tsx
interface PasswordlessSettings {
  hiddenAuthMethods?: ('PASSWORD' | 'EMAIL_OTP' | 'SMS_OTP' | 'WEB_AUTHN')[];
  preferredAuthMethod?: 'PASSWORD' | 'EMAIL_OTP' | 'SMS_OTP' | 'WEB_AUTHN';
  passkeyRegistrationPrompts?: {
    afterSignin?: 'ALWAYS' | 'NEVER';
    afterSignup?: 'ALWAYS' | 'NEVER';
  } | boolean;
}
```

**Properties:**

- `hiddenAuthMethods` - Hide specific authentication methods
- `preferredAuthMethod` - Skip method selection, use preferred method
- `passkeyRegistrationPrompts` - Control passkey registration prompts

#### Examples

**Full Configuration:**

```tsx
<Authenticator
  passwordless={{
    hiddenAuthMethods: ['PASSWORD'],
    preferredAuthMethod: 'WEB_AUTHN',
    passkeyRegistrationPrompts: {
      afterSignin: 'ALWAYS',
      afterSignup: 'ALWAYS'
    }
  }}
>
  {({ signOut, user }) => (
    <main>
      <h1>Hello {user?.username}</h1>
      <button onClick={signOut}>Sign out</button>
    </main>
  )}
</Authenticator>
```

**Email OTP Only:**

```tsx
<Authenticator
  passwordless={{
    hiddenAuthMethods: ['PASSWORD', 'SMS_OTP', 'WEB_AUTHN'],
    preferredAuthMethod: 'EMAIL_OTP'
  }}
/>
```

**Control Passkey Prompts:**

```tsx
<Authenticator
  passwordless={{
    passkeyRegistrationPrompts: {
      afterSignin: 'NEVER',
      afterSignup: 'ALWAYS'
    }
  }}
/>
```

**Disable Passkey Prompts:**

```tsx
<Authenticator
  passwordless={{
    passkeyRegistrationPrompts: false
  }}
/>
```