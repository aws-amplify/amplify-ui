import { Alert, Tabs } from '@aws-amplify/ui-react';
import PasswordlessExample from './passwordless.example.web.mdx';

### Passwordless Authentication

<Alert role="none" variation="info" heading="Platform Requirements">
  WebAuthn (Passkey) support requires modern browsers with WebAuthn API support.
</Alert>

#### Backend Configuration

For backend setup including Email OTP, SMS OTP, and WebAuthn (Passkey) configuration, see the [Passwordless documentation](https://docs.amplify.aws/react/build-a-backend/auth/concepts/passwordless/).

#### Basic Usage

The Authenticator automatically detects passwordless authentication methods from your backend (`amplify_outputs.json`):

<PasswordlessExample />

#### Available Authentication Methods

| Method | Description | Code |
|--------|-------------|------|
| PASSWORD | Traditional password authentication | `'PASSWORD'` |
| EMAIL_OTP | One-time code via email | `'EMAIL_OTP'` |
| SMS_OTP | One-time code via SMS | `'SMS_OTP'` |
| WEB_AUTHN | Biometric/security key authentication (Passkey) | `'WEB_AUTHN'` |

#### Configuration

Use the `passwordless` prop to:
- Override settings from `amplify_outputs.json`
- Configure passwordless for Gen 1 backends

```tsx
interface PasswordlessSettings {
  hiddenAuthMethods?: ('PASSWORD' | 'EMAIL_OTP' | 'SMS_OTP' | 'WEB_AUTHN')[];
  preferredAuthMethod?: 'PASSWORD' | 'EMAIL_OTP' | 'SMS_OTP' | 'WEB_AUTHN';
  passkeyRegistrationPrompts?: {
    afterSignin?: 'ALWAYS' | 'NEVER';
    afterSignup?: 'ALWAYS' | 'NEVER';
  } | boolean;
}
```

| Property | Type | Description |
|----------|------|-------------|
| `hiddenAuthMethods` | `AuthMethod[]` | Hide specific authentication methods from selection |
| `preferredAuthMethod` | `AuthMethod` | Skip method selection, use preferred method directly |
| `passkeyRegistrationPrompts` | `object \| boolean` | Control when passkey registration prompts appear |

#### Examples

<Tabs.Container defaultValue="full">
  <Tabs.List>
    <Tabs.Item value="full">Full Configuration</Tabs.Item>
    <Tabs.Item value="email">Email OTP Only</Tabs.Item>
    <Tabs.Item value="prompts">Configure Passkey Prompts</Tabs.Item>
    <Tabs.Item value="disable">Disable Passkey Prompts</Tabs.Item>
  </Tabs.List>
  <Tabs.Panel value="full">

```tsx
<Authenticator
  passwordless={{
    hiddenAuthMethods: ['PASSWORD'],
    preferredAuthMethod: 'WEB_AUTHN',
    passkeyRegistrationPrompts: {
      afterSignin: 'ALWAYS',
      afterSignup: 'ALWAYS'
    }
  }}
>
  {({ signOut, user }) => (
    <main>
      <h1>Hello {user?.username}</h1>
      <button onClick={signOut}>Sign out</button>
    </main>
  )}
</Authenticator>
```

  </Tabs.Panel>
  <Tabs.Panel value="email">

```tsx
<Authenticator
  passwordless={{
    hiddenAuthMethods: ['PASSWORD', 'SMS_OTP', 'WEB_AUTHN'],
    preferredAuthMethod: 'EMAIL_OTP'
  }}
/>
```

  </Tabs.Panel>
  <Tabs.Panel value="prompts">

```tsx
<Authenticator
  passwordless={{
    passkeyRegistrationPrompts: {
      afterSignin: 'NEVER',
      afterSignup: 'ALWAYS'
    }
  }}
/>
```

  </Tabs.Panel>
  <Tabs.Panel value="disable">

```tsx
<Authenticator
  passwordless={{
    passkeyRegistrationPrompts: false
  }}
/>
```

  </Tabs.Panel>
</Tabs.Container>