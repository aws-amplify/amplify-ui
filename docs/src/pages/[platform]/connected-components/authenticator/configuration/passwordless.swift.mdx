import { Alert } from '@aws-amplify/ui-react';

### Passwordless Authentication

<Alert role="none" variation="info" heading="Platform Requirements">
  Passkey support requires iOS 17.4+, macOS 13.5+, or visionOS 1.0+.
</Alert>

#### Backend Configuration

For backend setup including Email OTP, SMS OTP, and WebAuthn (Passkey) configuration, see the [Passwordless documentation](https://docs.amplify.aws/react/build-a-backend/auth/concepts/passwordless/).

#### Authentication Flows

The Authenticator supports two authentication flows:

**Password Flow (Default)**

Traditional password-based authentication:

```swift
Authenticator(authenticationFlow: .password) { signedInState in
    Text("Welcome!")
}
```

**User Choice Flow**

Allows users to choose from available authentication methods:

```swift
Authenticator(authenticationFlow: .userChoice()) { signedInState in
    Text("Welcome!")
}
```

#### Available Authentication Factors

| Factor | Description | Code |
|--------|-------------|------|
| Password | Traditional password with SRP | `.password(srp: true)` |
| Password (no SRP) | Password without SRP | `.password(srp: false)` |
| Email OTP | One-time code via email | `.emailOtp` |
| SMS OTP | One-time code via SMS | `.smsOtp` |
| WebAuthn (Passkey) | Biometric/device authentication | `.webAuthn` |

#### Preferred Auth Factor

Skip the factor selection step by specifying a preferred factor:

```swift
Authenticator(
    authenticationFlow: .userChoice(
        preferredAuthFactor: .webAuthn
    )
) { signedInState in
    Text("Welcome!")
}
```

When a preferred factor is set:
- If the user has that factor available, they'll use it directly
- If not available, they'll see the factor selection screen

#### Passkey Prompts

Control when users are prompted to create a passkey:

```swift
Authenticator(
    authenticationFlow: .userChoice(
        passkeyPrompts: PasskeyPrompts(
            afterSignUp: .always,  // Prompt after sign-up
            afterSignIn: .never    // Don't prompt after sign-in
        )
    )
) { signedInState in
    Text("Welcome!")
}
```

**PasskeyPrompt Options:**
- `.always` - Always prompt to create a passkey (if user doesn't have one)
- `.never` - Never prompt to create a passkey

#### Authentication Flow Steps

When using `.userChoice` flow, users may encounter these additional steps:

1. **signInSelectAuthFactor** - User selects their preferred authentication method
2. **signInConfirmPassword** - User enters password (if password factor selected)
3. **promptToCreatePasskey** - User is prompted to create a passkey
4. **passkeyCreated** - Confirmation after successful passkey creation

#### Complete Example

```swift
Authenticator(
    authenticationFlow: .userChoice(
        preferredAuthFactor: .webAuthn,
        passkeyPrompts: PasskeyPrompts(
            afterSignUp: .always,
            afterSignIn: .always
        )
    )
) { signedInState in
    Text("Welcome \(signedInState.user.username)!")
}
```
