import { Alert, Tabs, TabItem } from '@aws-amplify/ui-react';
import { Example, ExampleCode } from '@/components/Example';
import { BasicShoppingCard, AdvancedShoppingCard } from '../shared';
import { InstallScripts, TerminalCommand } from '@/components/InstallScripts.tsx';

## Tutorial

In this brief tutorial, we're going to build a basic shopping card component using [Next.js](https://nextjs.org/docs) and Amplify UI. Then, we'll elaborate on our shopping card to play with the possibilities of using Amplify UI.

### Setup and Installation

First, execute the command below in your terminal. When prompted for the name of your project, enter `amplify-ui-demo`. 

<Tabs>
  <TabItem title="npm">
    <TerminalCommand command="npx create-next-app@latest && cd amplify-ui-demo" />
  </TabItem>
  <TabItem title="yarn">
    <TerminalCommand command="yarn create next-app && cd amplify-ui-demo" />
  </TabItem>
</Tabs>

Then, install the Amplify UI React package:

<InstallScripts framework="react" />

### Usage

<Tabs>
  <TabItem title="Next.js 13.4+">
  <Alert variation="info" role="none">
    Amplify UI components only work in Client Components. If you need to load them into a Server Component, you need to convert them into client-side components by adding a `'use client'` at the top of your file. Please see instructions below on how you could achieve this. For more info, visit Next.js [documentation](https://nextjs.org/docs/getting-started/react-essentials#third-party-packages).
  </Alert>
#### UI Components

To use an Amplify UI component in Server Components, you must re-export them as Client Components.

An example below is shown for using Amplify UI `Button` component:

First, create a Client Component file _AmplifyUIComponents.jsx_ that re-exports `Button`. Make sure to place `'use client'` at the top of _AmplifyConnectedComponents.jsx_ to let Nextjs know that should be handled as a Client Component.

    <ExampleCode>

    ```tsx
    // AmplifyUIComponents.jsx
    'use client';

    import { Button } from '@aws-amplify/ui-react';
    import '@aws-amplify/ui-react/styles.css';

    export { Button };
    ```

    </ExampleCode>

Then, import `Button` from the Client Component and use it anywhere you want, e.g., `app/page.jsx`.

    <ExampleCode>

    ```tsx
    // app/page.jsx
    import { Button } from './AmplifyUIComponents';

    export default function Home() {
      return <Button>Hello, Amplify!</Button>;
    }
    ```

    </ExampleCode>

#### Connected Components
    To use an Amplify UI Connected Component within the _app_ directory, you must run `Amplify.configure` in a Client Component file.

    First, create a Client Component file _configure-client.js_ by placing `'use client'` at the top within _app_ directory:

    <ExampleCode>

    ```tsx
    // configure-client.js
    'use client';
  
    import { Amplify } from "aws-amplify";
    import '@aws-amplify/ui-react/styles.css';

    import config from "../src/aws-exports";
    
    Amplify.configure(config);
    ```

    </ExampleCode>

    Then import _configure-client.js_ in _layout.jsx_ to finish the setup,
   <ExampleCode>

    ```tsx
    // layout.jsx
    import "./configure-client";
    ...
    ```

    </ExampleCode>

You must re-export Connected Components as Client Components before using them in Server Components.

An example below is shown for `Authenticator` component:

First, create a Client Component, for example, _AmplifyConnectedComponents.jsx_ by placing `'use client'` at the top within _app_ directory,

    <ExampleCode>

    ```tsx
    // AmplifyConnectedComponents.jsx
    'use client';

    import { Authenticator } from '@aws-amplify/ui-react';
   
    export { Authenticator };
    ```

    </ExampleCode>

Then, import `Authenticator` from the Client Component and use it anywhere you want, e.g., _app/page.jsx_.

      <ExampleCode>

      ```tsx
      // app/page.jsx
      import { Authenticator } from './Authenticator';

      export default function Home() {
        return <Authenticator>Hello, Amplify!</Authenticator>;
      }
      ```

      </ExampleCode>

To use more Connected Components, you need to re-export them in the same Client Component _AmplifyConnectedComponents.jsx_ and then load them from there.

    <ExampleCode>

    ```tsx
    // AmplifyConnectedComponents.jsx
    'use client';

    import { Authenticator } from '@aws-amplify/ui-react';
    import { StorageManager } from '@aws-amplify/ui-react-storage';
    import '@aws-amplify/ui-react/styles.css';

    export { Authenticator, StorageManager };
    ```

    </ExampleCode>

**You may want to combine the setup and re-exports into a single Client Component.**

For example, create a Client Component file _AmplifyUI.js_ specific for Amplify UI under _app_ directory and then finish the setup with `Amplify.configure` and re-export everything you need from there.

    <ExampleCode>

    ```tsx
    // AmplifyUI.js
    'use client';

    import { Amplify } from 'aws-amplify';

    import { Authenticator, Button } from '@aws-amplify/ui-react';
    import '@aws-amplify/ui-react/styles.css';

    import awsExports from '../src/aws-exports';
    Amplify.configure(awsExports);

    export { Authenticator, Button };
    ```

    </ExampleCode>

For more info, see Next.js [documentation](https://nextjs.org/docs/getting-started/react-essentials#third-party-packages).

  </TabItem>
  <TabItem title="Next.js 11.0-13.3">
#### UI Components
To use Amplify UI components in page directory, simply import them into your modules.

An example below is shown for using Amplify UI `Button` component:

    <ExampleCode>

    ```tsx
    // src/pages/page.jsx
    import { Button } from '@aws-amplify/ui-react';
    import '@aws-amplify/ui-react/styles.css';

    export default function Page() {
      return (
       <Button>Hello, Amplify!</Button>
      );
    }
    ```

   </ExampleCode>

#### Connected Components
To use Amplify Connected Componnets in page directory, you must set up `Amplify.configure` in `src/pages/_app.jsx`

An example below is shown for `Authenticator` component:

    <ExampleCode>

    ```tsx
    // src/pages/_app.jsx
    import { Amplify } from 'aws-amplify';

    import { Authenticator } from '@aws-amplify/ui-react';
    import '@aws-amplify/ui-react/styles.css';

    import awsExports from '../aws-exports';
    Amplify.configure(awsExports);

    export default function App({ Component, pageProps }) {
      return (
        // your app
        <Authenticator>
          <Component {...pageProps} />
        </Authenticator>
      );
    }
    ```

   </ExampleCode>

  </TabItem>
</Tabs>

### Basic Demo

<Alert variation="info" role="none">
Next.js 13.4+ introduces [app directory](https://nextjs.org/docs/app/building-your-application/routing#the-app-directory) with the usage of [Server Components](https://nextjs.org/docs/getting-started/react-essentials#server-components). To use Amplify UI componenents, you must use them inside the Client Component tree by placing `"use client"` at the boundary between your Client and Server component module graph. Please see the Next.js [documentation](https://nextjs.org/docs/getting-started/react-essentials#third-party-packages) on how you could achieve this.

In this guide for Next.js 13.4+, we placed `"use client"` at the top of `page.jsx` for demonstration purposes.
</Alert>

<Tabs>
  <TabItem title="Next.js 13.4+">

Open up the project in your IDE and replace the contents of the `app/page.jsx` with the code below:

    <Example>
      <ExampleCode>
      
```tsx file=./examples/UseClientBasicExampleCode.tsx
```

      </ExampleCode>
      <BasicShoppingCard />
    </Example>
  </TabItem>
  <TabItem title="Next.js 11.0-13.3">

Open up the project in your IDE and replace the contents of the `pages/index.js` with the code below:

  <Example>
    <ExampleCode>
    
  ```tsx file=./examples/BasicExampleCode.tsx
  ```

    </ExampleCode>
    <BasicShoppingCard />
  </Example>

  </TabItem>
</Tabs>

When you start the app (`npm run dev` or `yarn dev`), you should see a basic shopping card component.

### Advanced Demo

<Tabs>
  <TabItem title="Next.js 13.4+">

If you’d like to play around with a more comprehensive demo of the Amplify UI library, create a separate file under the `app` folder named `paintings.js`, and copy/paste this code into it:

    <ExampleCode>

```tsx file=./examples/paintings.ts
```

    </ExampleCode>

Then, replace the contents of `app/page.jsx` with the code below, restart the app, and experience all the beautiful components in action!

    <Example>
      <ExampleCode>

```tsx file=./examples/UseClientAdvancedExampleCode.tsx
```

      </ExampleCode>
      <AdvancedShoppingCard />
    </Example>
  </TabItem>
  <TabItem title="Next.js 11.0-13.3">

If you’d like to play around with a more comprehensive demo of the Amplify UI library, create a separate file under the `pages` folder named `paintings.js`, and copy/paste this code into it:

    <ExampleCode>

```tsx file=./examples/paintings.ts
```

   </ExampleCode>

Then, replace the contents of `pages/index.js` with the code below, restart the app, and experience all the beautiful components in action!

    <Example>
      <ExampleCode>

```tsx file=./examples/AdvancedExampleCode.tsx
```

      </ExampleCode>
      <AdvancedShoppingCard />
    </Example>

  </TabItem>
</Tabs>
