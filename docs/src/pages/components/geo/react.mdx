import { Example } from '@/components/Example';
import { Feature } from '@/components/Feature';
import { Fragment } from '@/components/Fragment';
import { Tabs, TabItem } from '@aws-amplify/ui-react';

Amplify UI Geo is powered by
[Geo APIs](https://docs.amplify.aws/lib/geo/getting-started/q/platform/js/) and
[Amazon Location Service](https://aws.amazon.com/location/).

### Quick Start

> Prerequisites:
>
> 1. Install`@aws-amplify/ui-react`with [npm](https://www.npmjs.com/) or [yarn](https://yarnpkg.com/). ( e.g. `npm install @aws-amplify/ui-react`)
> 2. Create map resources by following the [Amplify Geo documentation](https://docs.amplify.aws/lib/geo/getting-started/q/platform/js/).

## MapView

The `MapView` component adds an interactive map to your application.

`MapView` is fully integrated with the open source library [react-map-gl](https://visgl.github.io/react-map-gl/) v7
while using [maplibre-gl-js](https://maplibre.org/maplibre-gl-js-docs/api/) as the map tile source. `MapView` is
used as a replacement to `react-map-gl`'s [default map](https://visgl.github.io/react-map-gl/docs/api-reference/map)
and supports the same functionality.

Install the required peer dependencies using your preferred package manager. Below, we use [Yarn](https://yarnpkg.com/)
as an example:

```shell
yarn add maplibre-gl-js@1 react-map-gl
```

You can import the `MapView` component with related styles and use it in your Amplify application without any
additional configuration.

<Fragment platforms={['react']}>
  {({ platform }) => import(`./fragments/map-quick-start.${platform}.mdx`)}
</Fragment>

### Setting Initial Viewport

The map's initial viewport can be set with the `initialViewState` property:

<Fragment platforms={['react']}>
  {({ platform }) => import(`./fragments/map-initial-viewport.${platform}.mdx`)}
</Fragment>

### Usage with react-map-gl

#### Moving Marker

The `Marker` component from the `react-map-gl` library can have dynamic `latitude` and `longitude` properties to create
a moving marker. The marker's position will reflect changes in `latitude` and `longitude`.

<Fragment platforms={['react']}>
  {({ platform }) => import(`./fragments/marker-moving.${platform}.mdx`)}
</Fragment>

#### Marker with Popup

The `Popup` component from the `react-map-gl` library can be used with a `Marker` to communicate information to a user
when the marker is clicked. The `offset` property can be used to prevent the popup from overlapping the marker.

<Fragment platforms={['react']}>
  {({ platform }) => import(`./fragments/marker-with-popup.${platform}.mdx`)}
</Fragment>

_Note: Ensure `originalEvent.stopPropagation()` is called in the marker click handler. This allows the `showPopup`
state to be handled by the component._

## Geocoder (Location Search)

`Geocoder` provides location search powered by [Amazon Location Service](https://aws.amazon.com/location/) for the
`MapView` component, using the viewport as the proximity for generating results. `Geocoder` is used as a child
component of `MapView` for which it renders visual markers and information based on its location search results.

You can import the `Geocoder` component with related styles and use it as a child of `MapView` without any
additional configuration.

<Fragment platforms={['react']}>
  {({ platform }) => import(`./fragments/geocoder-quick-start.${platform}.mdx`)}
</Fragment>

### Geocoder Position

`Geocoder` can be provided a `position` property when used with `MapView`. The property is not reactive, meaning the
position is fixed after the component mounts. Valid values are `'top-right'`, `'top-left'`, `'bottom-right'`, and
`'bottom-left'`. Default value is `'top-right'`.

<Fragment platforms={['react']}>
  {({ platform }) => import(`./fragments/geocoder-position.${platform}.mdx`)}
</Fragment>

### Standalone Geocoder

`Geocoder` can also be used as a standalone component without `MapView`. As a standalone component, `Geocoder`
provides search results based on an initial proximity. When used as a standlone component, the `proximity` property
with provided `latitude` and `longitude` properties is required.

<Fragment platforms={['react']}>
  {({ platform }) => import(`./fragments/standalone-geocoder.${platform}.mdx`)}
</Fragment>
